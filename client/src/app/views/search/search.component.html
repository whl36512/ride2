<div class="search main">
	<span class=hide-unhide>
		<button  type="button" (click)="show_body='noshow'" > &#xfe3f; </button> 
		<button  type="button" (click)="show_body='show'" > &#xfe40; </button> 
	</span>
	<br/><div class="center f12">Search</div>
	<button   class="close-button" type="button" (click)="close_page()" > X </button>
	<div class={{show_body}} >
	<form [formGroup]="form" (ngSubmit)="onSubmit()">
		<dl *ngIf="step==1"> 
          		<dt>
				<label for="start_loc">Exact Pickup Location
				</label>
			</dt>
          		<dd>
	   			<input  type="text"  id="start_loc" formControlName="start_loc" placeholder="From" required
	                                   (keyup)='geocode("start_loc")' 
	                                   (blur)='geocode("start_loc")' 
					pattern=".{3,}"
					*ngIf="!form_saved_to_db"
				/>
				<span class="validity"></span>
			</dd>
          		<dd  class="f08"> 
				{{trip.start_lat}}  {{trip.start_lon}} 
			</dd>
			<dd class="f08">
				{{trip.start_display_name}}
			</dd>
        	</dl>

        	<dl *ngIf="step==2">
          		<dt>
				<label for="end_loc">Exact Dropoff Location</label>
			</dt>
          		<dd>
	   			<input  type="text"  id="end_loc" formControlName="end_loc" placeholder="To" required
	                                   (keyup)='geocode("end_loc")'  
	                                   (blur)='geocode("end_loc")' 
					pattern=".{3,}"
					*ngIf="!form_saved_to_db"
				/>
				<span class="validity"></span> 
			</dd>
			<dd class="f08">
				{{trip.end_lat}} {{trip.end_lon}} 
			</dd>
			<dd class="f08">
				{{trip.end_display_name	}}
			</dd>
			<dt>
			Distance (miles): 
			<span *ngIf="trip.distance==ERROR_NO_ROUTE " error=true>{{trip.distance}}</span>
			<span *ngIf="trip.distance!=ERROR_NO_ROUTE "           >{{trip.distance}}</span>
			</dt>
        	</dl>

        	<dl *ngIf="step==3">
          		<dt><label for="start_date">Search from</label></dt>
          		<dd> <input type="date" formControlName="start_date" min={{today}} required/> 
				<span class="validity"></span>
			</dd>
          		<dt><label for="end_date">Search to</label></dt>
          		<dd> <input type="date" formControlName="end_date" min={{this.form.value.start_date}} /> 
				<span class="validity"></span>
			</dd>

          		<dt><label for="departure_time">Departure Time</label></dt>
          		<dd> <input type="time" formControlName="departure_time" step="60" /> </dd>
        	</dl>

        	<dl *ngIf="step==4">
			<dt><label for="seats">Passengers: {{this.form.value.seats}}  </label></dt>
          		<dd>
			<input type="range" formControlName="seats" min="1" max="{{MAX_SEATS}}" step=1 /> 
          		</dd>

			<dt><label for="price">Max Price: ${{this.form.value.price}} per mile per passenger</label></dt>
          		<dd>
			<input type="range" formControlName="price" min="0" max="{{MAX_PRICE}}" step=0.01 />
          		</dd>
        	</dl>
		<br/>
		<button  type="button" *ngIf="step>1" (click)="step=step-1">&lt; Back</button> &nbsp; &nbsp;
		<button  type="button" *ngIf="step<4" (click)="step=step+1">Next &gt;</button>
        	<span *ngIf="step==4">
			<button  type="submit" [disabled]="form.invalid || trip.distance==null || trip.distance=='no route' " >Search</button> 
		</span>
      	</form>
	<div *ngIf='error_msg!=null' class=error>{{error_msg}}</div>
	<div *ngIf='warning_msg!=null' class=warning>{{warning_msg}}</div>
	<div *ngIf='info_msg!=null' class=info>{{info_msg}}</div>

	<p>
      	<app-journey *ngIf='journeys_from_db.length!=0' 
			[journeys_from_db]="journeys_from_db" 
			>
	</app-journey>
	</div>
</div>
